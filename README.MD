# ğŸ—ºï¸ Supmap - Real-time Navigation Application

Supmap (Trafine) is a real-time navigation application built with a microservices architecture, providing traffic information, incident reporting, and route optimization.

## ğŸš€ Production Environment Setup

To run the entire system in production mode, follow these steps:

### ğŸ“‹ Prerequisites

- ğŸ³ Docker and Docker Compose installed
- ğŸ“± A mobile device with Expo Go app installed (for mobile app access)
- ğŸ“¶ Mobile device and host machine on the same Wi-Fi network

### âš™ï¸ Configuration

1. **Clone the repository**

   ```bash
   git clone https://github.com/kyomawa/4PROJ.git
   cd 4PROJ
   ```

2. **Configure environment variables**

   ```bash
   cp .env.example .env # Dont do it if you already have .env file
   ```

   Edit the `.env` file and configure all required variables.

   **ğŸ”´ Critical configuration:**

   - **Set `EXPO_PUBLIC_API_BASE_URL` to your machine's IPv4 address** (not `localhost`)

     ```
     EXPO_PUBLIC_API_BASE_URL=http://192.168.1.10  # Replace with your actual IPV4
     ```

   To find your IP address:

   - ğŸªŸ Windows: `ipconfig`
   - ğŸ§ Linux/Mac: `ifconfig` or `ip addr`

   âš ï¸ **Important:** The mobile app will NOT work if you use `localhost` or `127.0.0.1`

3. **Start the production environment**
   ```bash
   docker-compose -f docker-compose.prod.yml up --build
   ```

### ğŸ“± Accessing the Mobile App

1. **Ensure network connectivity**

   - ğŸ“¡ Your mobile device MUST be on the same Wi-Fi network as the host machine
   - ğŸ”“ The network must allow LAN communication (some corporate/public networks restrict this)

2. **Launch the mobile app**

   - ğŸ“² Install the **Expo Go** app on your mobile device
   - ğŸ“‹ Check the logs of the `mobile-app-service` container:

     ```bash
     docker logs -f supmap-mobile-app-service-1
     ```

   - ğŸ“· Scan the QR code displayed in the logs using the Expo Go app
   - ğŸ”— Alternatively, use the tunnel URL provided in the logs

### ğŸŒ Service Access Points

Once running, you can access the following services:

- **ğŸ–¥ï¸ Website**: [http://localhost](http://localhost)
- **ğŸ“Š Traefik Dashboard**: [http://traefik.localhost](http://traefik.localhost) (requires authentication)
- **ğŸ”Œ API Endpoints**: Available through `/api/{service-name}` routes

### ğŸ“š Service Documentation

For detailed information about each service, refer to their individual READMEs:

- **[ğŸš¨ Alert Service](alert-service/README.MD)** - Real-time traffic alerts using SignalR
- **[ğŸ” Auth Service](auth-service/README.MD)** - User authentication and JWT token management
- **[âš ï¸ Incident Service](incident-service/README.MD)** - Traffic incident reporting and management
- **[ğŸ§­ Navigation Service](navigation-service/README.MD)** - Route calculation and optimization
- **[ğŸ“ˆ Statistics Service](statistic-service/README.MD)** - Analytics and reporting
- **[ğŸ‘¤ User Service](user-service/README.MD)** - User account management
- **[ğŸŒ Website Service](website-service/README.md)** - Web frontend application
- **[ğŸ“± Mobile App Service](mobile-app-service/README.MD)** - React Native mobile application

## ğŸ’» Development Environment Setup

For development with live reload capabilities:

1. **Configure environment variables** (same as production setup)

2. **Run with watch mode**

   ```bash
   docker compose watch
   ```

   Or without watch mode:

   ```bash
   docker compose up --build
   ```

3. **Access services in development**
   - ğŸŒ Web service: [http://localhost](http://localhost)
   - ğŸ§­ Navigation service: [http://navigation.localhost](http://navigation.localhost)
   - âš ï¸ Incident service: [http://incident.localhost](http://incident.localhost)
   - ğŸ‘¤ User service: [http://user.localhost](http://user.localhost)
   - ğŸ” Auth service: [http://auth.localhost](http://auth.localhost)
   - ğŸš¨ Alert service: [http://alert.localhost](http://alert.localhost)
   - ğŸ“ˆ Statistics service: [http://statistics.localhost](http://statistics.localhost)
   - ğŸ“Š Traefik dashboard: [http://localhost:8080](http://localhost:8080)

## ğŸ”§ Troubleshooting

### ğŸ“± Mobile App Connection Issues

1. **Network Configuration**

   - âœ… Verify both devices are on the same Wi-Fi network
   - ğŸ›¡ï¸ Check that your firewall allows connections on ports 19000, 19001, and 8081
   - ğŸš« Ensure the network doesn't block LAN communication

2. **IP Address Issues**

   - ğŸ” Double-check that `EXPO_PUBLIC_API_BASE_URL` contains your correct IPv4 address
   - ğŸ”„ Restart the mobile-app-service after changing the IP address
   - ğŸ“¡ Try using the tunnel option in Expo if direct connection fails

3. **Container Issues**
   - ğŸ“ Check container logs: `docker logs supmap-mobile-app-service-1`
   - ğŸ’š Ensure all services are healthy: `docker ps`
   - ğŸ”„ Restart specific services if needed

## ğŸ—ï¸ Architecture Overview

Supmap is built using a microservices architecture with the following components:

- **ğŸ”§ Backend Services**: .NET 8.0 microservices handling specific business domains
- **ğŸ¨ Frontend**: Next.js web application and React Native mobile app
- **ğŸ­ Infrastructure**: Traefik for API gateway and routing, MySQL for data persistence
- **ğŸ“¡ Communication**: REST APIs, SignalR for real-time updates

## ğŸ“ˆ Scaling Services

Both development and production setups support service scaling:

```bash
# Production
docker-compose -f docker-compose.prod.yml up --build --scale navigation-service=2

# Development
docker compose up --build --scale navigation-service=2
```

## ğŸ‘¥ Contributors

This project was developed by:

- CELLIER Bryan
- MASHAYEKH Sarvenaz
- CHOUGAR Lyes
- PEREZ Victor
